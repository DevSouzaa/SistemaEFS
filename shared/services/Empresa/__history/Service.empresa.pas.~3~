unit Service.Empresa;

interface

uses
  Empresa, RepositorioEmpresa, Generics.Collections;

type
  TEmpresaService = class
  private
    FRepositorio: TEmpresaRepositorio;
  public
    constructor Create(ARepositorio: TEmpresaRepositorio);
    function ObterPorId(Id: Integer): TEmpresa;
    function ObterTodas: TList<TEmpresa>;
    function Salvar(Empresa: TEmpresa): Boolean;
    function Deletar(Id: Integer): Boolean;
  end;

implementation

constructor TEmpresaService.Create(ARepositorio: TEmpresaRepositorio);
begin
  FRepositorio := ARepositorio;
end;

function TEmpresaService.ObterPorId(Id: Integer): TEmpresa;
begin
  Result := FRepositorio.ObterPorId(Id);
end;

function TEmpresaService.ObterTodas: TList<TEmpresa>;
begin
  Result := FRepositorio.ObterTodos;
end;

function TEmpresaService.Salvar(Empresa: TEmpresa): Boolean;
begin
  if Empresa.Id = 0 then
    Result := FRepositorio.Inserir(Empresa)
  else
    Result := FRepositorio.Atualizar(Empresa);
end;

function TEmpresaService.Deletar(Id: Integer): Boolean;
begin
  Result := FRepositorio.Deletar(Id);
end;

end.

